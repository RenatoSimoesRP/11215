========== Balloon-dtl.20 ==========Check for sending ShortRunArray class>>swapRuns and ShortIntegerArray class>>swapShortObjects is needed only at image startup time, so use startUp: resuming rather than startUp. Categorize in system startup.========== Network-fbs.139 ==========Move FTPConnectionException to Network-Protocols.========== Collections-fbs.501 ==========Typo correction.>>> Collections-cmm.500 <<<Categorize overridden method.>>> Collections-cmm.499 <<<FloatCollection inherits the convenient add:/remove: API of OrderedCollection, but using an internal FloatArray for better efficiency.>>> Collections-bf.498 <<<Merge Collections-topa.366: Provide #asCamelCase for Strings.>>> Collections-nice.497 <<<Thu shalt not invoke super in vain========== CollectionsTests-nice.198 ==========Diminish excessive usage of ReadWriteStream>>> CollectionsTests-fbs.197 <<<Missing tests for String >> #asCamelCase.http://bugs.squeak.org/view.php?id=7725>>> CollectionsTests-cmm.196 <<<fix>>> CollectionsTests-cmm.195 <<<Tests for FloatCollection.========== Monticello-fbs.532 ==========Installer repository failover #1 of 2: Make MCRepositoryGroup behave more like a repository, finding the repository/repositories containing a particular version.>>> Monticello-bf.531 <<<Add "search history" to version history browser, too.>>> Monticello-hjh.530 <<<Updated comments in MCDefinition, MCPackage and MCSnapshot after review by Bert Freudenberg.>>> Monticello-hjh.529 <<<Added comments to MCDefinition, MCPackage and MCSnapshot. A MCDefinition is a model for Smalltalk code. A package snapshot (MCSnapshot) is a collection of these definitions.MCPackage uses PackageInfo to find out which methods and classes belong to a package.>>> Monticello-nice.528 <<<Let MCTool inherit from Model.This is to avoid nasty garbage to survive in DependentsFields with kilo bytes of un-released MCDefinition cache.========== Kernel-nice.742 ==========Diminish excessive usage of ReadWriteStream>>> Kernel-nice.741 <<<Reduce the number of hardcoded constants used by #raisedTo:modulo:This will enable smooth transition to next generation of LargeIntegersPlugin.>>> Kernel-eem.740 <<<Move the code to set the owning method of anAdditionalMethodState to the setter away from clients.Add an anti-sharing check.>>> Kernel-fbs.739 <<<Stay in the debugger for longer. Part 3 of 5.Stack introspection so the Debugger doesn't have to. Signal the new exceptions when necessary.>>> Kernel-dtl.733 <<<Remove EventSensor>>wait2msUse of EventSensor>>wait2ms in sensor direct access to mouse and keyboard causes slow and incorrect keyboard handling in MVC. In newer Squeak images (3.9 and later), removing the delay restores normal MVC keyboard input.This change removes the wait2ms delay entirely. If the problem described in http://lists.squeakfoundation.org/pipermail/squeak-dev/2007-May/116185.html should reappear, a different solution will be required.Notes:In Squeak trunk, the wait2ms delay is invoked only when in MVC. However, Scratch (and possibly other applications) makes use of direct sensor access from Morphic (arguably this is an error in Scratch, but the usage exists nonetheless).Background:Recent thread in which StÃ©phane Rollandin identified the source of the problem:http://lists.squeakfoundation.org/pipermail/squeak-dev/2013-February/168526.htmlRationale for introducing the delay in earlier versions of Squeak:http://lists.squeakfoundation.org/pipermail/squeak-dev/2007-May/116185.html>>> Kernel-eem.732 <<<Make CompiledMethod>>removeProperty:[ifAbsent:] get ridof the AdditionalMethodState if the resulting state is empty.Streamline BlockClosure>>newProcess[With:] which doesnot need to run unwinds if control reaches the end ofthe process.Use the abstract blockCreationBytecodeMessage to computeBlockClosure's size instead of accessing bytecodes directly.>>> Kernel-nice.731 <<<merge nice+bf 730>>> Kernel-bf.730 <<<Cache source files during class mutation for noticeable speedup with larger hierarchies.>>> Kernel-nice.729 <<<Use at:ifAbsentPut: instead of at:ifAbsent: [ at:put: ]This is an update of http://bugs.squeak.org/view.php?id=5667>>> Kernel-nice.728 <<<Fix http://bugs.squeak.org/view.php?id=7605.Creating a new Float of size ~= 2 may crash the image.With this change it is safe to create a Float new (0.0), no use to forbid it.Thanks Levente========== Compiler-eem.252 ==========Yet another fix for decompilation of to:do: loops compiledwith Compiler-nice.224 or later.  If the stack is non-emptywhen convertDoDoLoop is invoked, the stack must be leftnon-empty.  This really does fix decompilation of e.g.	^nil to: 3 do: [:i| i class]and not just	true ifTrue: [^thisContext method decompile].	^nil to: 3 do: [:i| i class]>>> Compiler-eem.251 <<<Yet another fix for decompilation of to:do: loops compiledwith Compiler-nice.224 or later.  If the stack is non-emptywhen convertDoDoLoop is invoked, the stack must be leftnon-empty.  This fixes decompilation of e.g.^nil to: 3 do: [:i| i class]>>> Compiler-eem.250 <<<Fix incomplete fix for decompilation of #to:do: loops inCompiler-eem.242.  Fixes decompilation of e.g. compilationof SoundRecorder>>segmentsAbove:normalizedVolume:when compiled with Compiler-nice.224 or later.>>> Compiler-eem.249 <<<Simplify Parser>expression.  braceExpression is handled inprimaryExpression, as it should be.  The extra invocation inexpression is unnecessary, and harmlessly erroneous.Fix snafu with Compiler-eem.248 (slightly less circuitous generation of methods with temp names).>>> Compiler-eem.248 <<<Slightly less circuitous generation of methods with tempnames.  Since schematic temp names string is computedduring generation, best to generate a method and copyit with the computed temp names than generate twoseparate methods.========== EToys-nice.90 ==========Use at:ifAbsentPut: instead of at:ifAbsent: [ at:put: ]This is an update of http://bugs.squeak.org/view.php?id=5667========== Exceptions-fbs.44 ==========Move FTPConnectionException to Network-Protocols.>>> Exceptions-fbs.43 <<<Stay in the debugger for longer. Part 2 of 3.New exception hierarchy lets interesting parties catch NotImplemented errors to encourage developers to implement missing parts.========== Graphics-nice.200 ==========Bugfix: reading a XBM image with bits specified in decimal would fail to read a '0' byte.>>> Graphics-eem.199 <<<Use isNumber in fixing MNU in Smalltalk specialObjectsArray printString.Point>>printOn: shouldn't assume its inst vars are numbers.>>> Graphics-eem.198 <<<Fix MNU in Smalltalk specialObjectsArray printString.Point>>printOn: shouldn't assume its inst vars are numbers.>>> Graphics-bf.197 <<<Make grabbing color cursor from screen work. E.g. (CursorWithAlpha fromUser showWhile: [Sensor waitButton])>>> Graphics-nice.196 <<<Some degenerated rectangles (lines) can intersects: even though they have a null area.========== GraphicsTests-nice.31 ==========Some degenerated rectangles (lines) can intersects: even though they have a null area.========== Installer-Core-fbs.365 ==========http://bugs.squeak.org/view.php?id=7722Use FileDirectory's abstractions rather than relying on a platform specific path separator.>>> Installer-Core-fbs.364 <<<InstallerSqueakMap should use Installer's user input sanitising methods.>>> Installer-Core-TestRunner.363 <<<Installer repository failover #2 of 2: InstallerMonticello uses an MCRepositoryGroup, so that attempting to load a particular version will try each repository in turn. #basicView will open _all_ the InstallerMonticello's repositories.>>> Installer-Core-fbs.361 <<<Mantis #7726: Installer should sanitise user input. Now we can handle whitespace around/between package names/versions.========== KernelTests-nice.246 ==========Diminish excessive usage of ReadWriteStream>>> KernelTests-nice.245 <<<Reduce the number of hardcoded constants used by #raisedTo:modulo: tests too.>>> KernelTests-nice.244 <<<Avoid using ReadWriteStream gratuitously when we just need a WriteStream.>>> KernelTests-fbs.243 <<<Stay in the debugger for longer. Part 5 of _5_.Tests showing the signalling of the new style marker methods.>>> KernelTests-nice.240 <<<Test expectations of Euclidean division with quotient rounded toward zero (quo: rem:) or toward negative infinity (// \\) for various range of Integer.========== System-nice.513 ==========Diminish excessive usage of ReadWriteStream.Bonus: correct outdated code sample in comment>>> System-dtl.512 <<<Only the instance of SystemOrganizer that is the global SystemOrganization should send change notifications to the singleton SystemChangeNotifier.Addresses the case of a FileContentsBrowser that uses a new SystemOrganization to load code for browsing and should not initiate a system change notification for the class being browsed, as reported by Bob Arning on squeak-dev http://lists.squeakfoundation.org/pipermail/squeak-dev/2013-January/167941.html>>> System-fbs.511 <<<Filenames like "3+4.st" are perfectly valid, but need to be URL encoded.I would be happy to see a simpler implementation.>>> System-bf.510 <<<Wouldn't it be useful to know how old an object is? In our images there are objects that were created more than 30 years ago, after all. With this, we will know when objects were created, starting from today. See ObjectHistory's class comment for details.>>> System-nice.509 <<<Use at:ifAbsentPut: instead of at:ifAbsent: [ at:put: ]This is an update of http://bugs.squeak.org/view.php?id=5667========== GetText-eem.26 ==========Fix clearAllDomains.  It used to use the non-existentallCompiledMethodsDo:.========== Morphic-nice.641 ==========Correct blinkPrevParen: (only in absence of Shout).simplify an initialization.>>> Morphic-nice.640 <<<Diminish excessive usage of ReadWriteStream>>> Morphic-tfel.639 <<<Avoid redrawing the main docking bar all the time. This is a huge resource hog if you reach the threshold in the DamageRecorder and the docking bar damage rectangle is merged with the others, effectively forcing a huge chunk of the World redrawn>>> Morphic-fbs.638 <<<Stay in the debugger for longer. Part 1 of 3.UI hooks to create overriding methods.>>> Morphic-bf.636 <<<Merge Morphic-kb.619: - a fix to avoid DockingBarMorph holding onto windows>>> Morphic-bf.635 <<<DockingBarUpdatingMenuMorph: forget references held in menu items as soon as menu is closed>>> Morphic-dtl.634 <<<Fix for Morphic layout bug reported by Bob Arning in http://lists.squeakfoundation.org/pipermail/squeak-dev/2013-January/167757.htmlInvalidate changed regions in Morph>>layoutBounds: in the same manner as in Morph>>doLayoutIn:========== Multilingual-fbs.157 ==========Lars' fix for Mantis report #7709: Image Segments can't be written to file anymore.========== ST80-dtl.142 ==========Revert last change to zapSelectionWithCompositionWith: because original implementation is required for multilingual support.Change ParagraphEditor>>readKeyboard to always process one character at a time per suggestion from Bob Arning.Background and explanation at http://lists.squeakfoundation.org/pipermail/squeak-dev/2013-February/168725.html>>> ST80-dtl.141 <<<Fix ParagraphEditor>>zapSelectionWithCompositionWith: failing to reset setMark or setPoint values after converting to Unicode in the case of an input string of length > 1. The problem was apparent only in the case of keyboard entry from MVC when a wait2ms delay causing two or more characters to be buffered prior to handling the zap selection. Problem was best exhibited using a Linux interpreter VM with poor delay time resolution. This update fixes the problem in MVC but has not been tested with Unicode input (author is using US English keyboard and locale).Problem identified by Bob Arning: http://lists.squeakfoundation.org/pipermail/squeak-dev/2013-February/168666.html>>> ST80-nice.140 <<<Use degreesToRadians where due========== SUnit-cmm.92 ==========Remove obsolete test.>>> SUnit-eem.91 <<<Robust testCase printing.  i.e. TestCase new asString shouldnot raise an error.>>> SUnit-cmm.90 <<<- Do not wipe out pre-initialized state on TestCases.  Tests do not need to be prevented from running more than once if proper setUp/tearDown methods are present.========== ScriptLoader-eem.335 ==========Update ScriptLoader>>cleanUpMethods.Add voidMapCache and use startTimerEventLoop insteadof obsolete startTimerInterruptWatcher>>> ScriptLoader-nice.334 <<<Reduce level of superstition: 1 garbageCollect is worth 3.========== Sound-dtl.33 ==========Bitshift optimizations by Nicolas Cellier. Use #>> or #<< operator rather than #bitShift: in cases where shift direction is known in order to eliminate runtime check for shift direction in compiled VM methods.These changes affect ADPCMCodec methods that are translated as primitives in the ADPCMCodecPlugin and are thus part of the compiled VM. See VMMaker-dtl.293 in the VMMaker repository for related changes affecting other methods in the VM.Discussion thread: http://lists.squeakfoundation.org/pipermail/vm-dev/2012-December/011688.htmlOriginal change sets: http://code.google.com/p/cog/issues/detail?id=111========== Tests-eem.188 ==========Provde a test for Compiler-eem.251 which shows its stillbroken.  I fixed decompilation of	true ifTrue: [^thisContext method decompile].	^nil to: 3 do: [:i| i class]but /not/ decompilation of	^nil to: 3 do: [:i| i class]	tsk, tsk.>>> Tests-fbs.187 <<<Mantis #7726: tests for Installer >> #packageAndVersionFrom:>>> Tests-fbs.186 <<<Tests for Lars' Mantis report #7709: Image Segments can't be written to file anymore.>>> Tests-fbs.185 <<<#assert:equals: (and even more so #assert:equals:description:) is just so much nicer than a bare #assert:.>>> Tests-fbs.184 <<<OrderedCollection's printString is inadequate for logging this error: rather, manually join the offending unbound globals with a comma.>>> Tests-fbs.183 <<<Fail with a more meaningful description of the problem.>>> Tests-fbs.182 <<<Environment >> #at:ifPresent:ifAbsent:.>>> Tests-fbs.181 <<<While valuable enough on its own, this test really aims to try nail down/understand the failure in testClassRemovalAndRecompilationWontCreateDuplicateVariableBindings.>>> Tests-fbs.180 <<<This does _not_ fix the failing test. I'm renaming in a separate commit so that the actual fix is apparent (when someone does so).>>> Tests-fbs.179 <<<Update PackageDependencyTest to reflect the new relationships between Environments and other packages.========== ToolBuilder-MVC-dtl.31 ==========Make proportionally spaced buttons work in MVC. Fixes missing buttons on the debug notifier.If the spec for a widget has a frame that is a LayoutFrame rather than a Rectangle, then it is intended to be scaled within the boundaries of a containing widget. The spec does not contain size hints in this case. Subviews (e.g. buttons in a horizontal layout) are created with initial window size matching the superview. Resize the subview windows such that the subviews are contained within the superview window.Also allow for a pluggable button to have an initial label (evaluate label selector at view creation) to serve as a size hint in view construction.>>> ToolBuilder-MVC-dtl.30 <<<Make browsers work in MVC.Arrange for subviews (e.g. a row of buttons in a browser) to be scaled properly and to be translated to the viewport of the containing view.View coordinate systems are transformed relative to their containing views, not to the top level view, so change MVCToolBuilder>>asWindow: to scale relative to window of the containing view.Change MVCToolbuilder>>buildPluggablePanel to call setFrame:in: prior to building subviews so that the view window is available to subviews for scaling subview windows.In MVCToolBuilder>>setLayout:in adjust translation in the window transformation of subviews to position correctly in their viewports.Caution - save image before testing, other problems await.========== Tools-nice.448 ==========FakeClassPool is obsolete in Squeak, remove recent reference to it.Note: we should deprecate this class>>> Tools-nice.447 <<<Diminish excessive usage of ReadWriteStream>>> Tools-fbs.446 <<<Fixes http://bugs.squeak.org/view.php?id=7730If you're browsing class Foo, there's no need to go back to Foo, so don't show it in the list of recently visited classes.>>> Tools-fbs.445 <<<Stay in the debugger for longer. Part 4 of _5_.Implement the Debugger side of things. Actually _remove_ the frame that signaled the NotImplemented from the call stack.>>> Tools-bf.439 <<<When debugging a process from ProcessBrowser, do not try to resume it (see http://lists.squeakfoundation.org/pipermail/squeak-dev/2012-December/166749.html)>>> Tools-bf.438 <<<Fix changes in debugger getting lost when reverting to method from an inner block. As reported by Aran Lunzer:Set up the following method on some class:bugger  | a1 |  a1 := 0.  [ 2 / a1 ] valuethen send   <class> new buggerIn the walkback, try changing the last line to  [ b1:=2.  2 / a1 ] value(oops - said b1 instead of a1...)Debugger asks if it's ok to revert to the method in which the block was defined.  Say ok.  Then it asks about adding b1 as a new variable (NB: at this stage, the code edits have already disappeared).  Then cancel, intending to fix the variable name.  But your edits are lost.>>> Tools-fbs.437 <<<We already have the organizer. No need to look it up again.>>> Tools-fbs.436 <<<We already have the organization in classOrganizer. CodeHolder's version goes and looks it up.>>> Tools-fbs.435 <<<Don't use Class objects when all you care about is a name.>>> Tools-fbs.434 <<<Pulling these bits out makes new kinds of Browsers able to partially override behaviour.========== ToolsTests-nice.61 ==========Reduce level of superstition: 1 garbageCollect is worth 3.>>> ToolsTests-fbs.60 <<<Much better testing for Browser >> #annotationForClassCommentFor:.>>> ToolsTests-fbs.59 <<<More characterisation tests. Note that #testClassCommentAnnotation is 'forward looking', in that it defines the soon-to-be behaviour of Browser >> #annotationForClassCommentFor:.>>> ToolsTests-fbs.58 <<<Basic labelString tests. These don't test the multiwindow labelStrings though.>>> ToolsTests-fbs.57 <<<Test that when you select a system category in a new Browser, you see what you expect to see: a template for creating a new class.========== ReleaseBuilder-fbs.92 ==========Implement Eliot Miranda's request to clear all text domains, and recompile everything prior to release.Technically we only need to recompile when we change the Compiler, but doing it every time we release something is much simpler/easier: I can't imagine how we'd write a ReleaseBuilder that would know (without introspecting on some source of version history somewhere) that the Compiler had just changed.>>> ReleaseBuilder-nice.91 <<<Reduce level of superstition: 1 garbageCollect is worth 3.Don't collect garbage before Symbol compactSymbolTable., because this one will invoke garbageCollect by itself.========== Environments-fbs.13 ==========Max Leske's fix to Environments to support Fuel (hence the methods being in the compatibility category).>>> Environments-bf.12 <<<Environment>>bindingOf: must not answer undeclared bindings. E.g., in my case a binding in undeclared shadowed a perfectly fine class variable higher up in the class hierarchy.>>> Environments-fbs.11 <<<For the moment - until we're sure about the proper API for environments - put things that mimic Dictionary methods in the compatibility protocol.>>> Environments-fbs.10 <<<Environment >> #at:ifPresent:ifAbsent:.>>> Environments-fbs.9 <<<The ReleaseSqueakTrunk CI job fails because it raises a debugger. This avoids that problem.